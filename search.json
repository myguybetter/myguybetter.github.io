[{"title":"Shadowsocks-libev配置小记","url":"/2019/08/proxy-settings/","content":"\n### 1. 下载、安装\n- 下载最新release：[Download](https://github.com/shadowsocks/shadowsocks-libev/releases \"Download\")\n- 安装shadowsocks-libev：\n```bash\nmkdir -p ~/build-area/\ncp ./scripts/build_deb.sh ~/build-area/\ncd ~/build-area\n./build_deb.sh\n```\n- 安装最新v2ray-plugin（链接最后添加`#artifacts`下载对应系统文件）：[Download](https://circleci.com/gh/shadowsocks/v2ray-plugin/tree/master \"Download\")\n\n### 2. 配置服务器设置\nconfig_sample.json，文件命名以config_0.json, config_1.json...\n```json\n{\n    \"server\":\"0.0.0.0\",\n    \"mode\":\"tcp_and_udp\",\n    \"server_port\":server_port,\n    \"local_port\":1080,\n    \"password\":\"password_here\",\n    \"timeout\":60,\n    \"method\":\"method_here\",\n    \"plugin\":\"v2ray-plugin_location\",\n    \"plugin_opts\":\"server;tls;host=domain_here;cert=fullchain_file;key=key_file\"\n}\n```\n### 3. 配置服务\n#### 创建批量启动脚本\n在`/usr/local/bin`建立脚本`shadowsocks-libev-autostart`并添加执行权限，`args`为全局通用参数。\n```bash\n#!/bin/sh\n\nproc=/usr/bin/ss-server\nconfig_dir=/etc/shadowsocks-libev\nargs=\"-n 32678 -u --fast-open -v\"\n\n$proc -c $config_dir/config_0.json -f /var/run/shadowsocks-libev_0.pid $args\t#port 0\n$proc -c $config_dir/config_1.json -f /var/run/shadowsocks-libev_1.pid $args\t#port 1\n\nexit 0\n```\n#### 创建Systemd服务\n在`/etc/systemd/system`下建立`shadowsocks-libev.service`，内容如下：\n```bash\n[Unit]\nDescription=Shadowsocks-libev Multi-user Server Service\nDocumentation=man:shadowsocks-libev(8)\nAfter=network.target\n\n[Service]\nType=forking\nUser=root\nLimitNOFILE=32768\nExecStart=/usr/local/bin/shadowsocks-libev-autostart\n\n[Install]\nWantedBy=multi-user.target\n```\n启用服务`systemctl enable shadowsocks-libev`\n\n启动服务`systemctl start shadowsocks-libev`\n\n部分参考[Shadowsocks-libev多端口配置](https://asdasd.page/2018/06/21/Shadowsocks-libev-Multiple-Port-with-Systemd/ \"Shadowsocks-libev多端口配置\")。","tags":["shadowsocks-libev"]}]